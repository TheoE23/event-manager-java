<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<div th:replace="fragments/layout :: layout(~{::section})">

    <section style="max-width: 1100px; margin: 40px auto;">

        <div style="
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
        ">

            <h2 style="margin-bottom: 25px;">Events</h2>

            <div th:if="${error}" style="color: #e74c3c; font-weight: bold; margin-bottom: 15px;">
                <p th:text="${error}"></p>
            </div>

            <div th:if="${success}" style="color: #2ecc71; font-weight: bold; margin-bottom: 15px;">
                <p th:text="${success}"></p>
            </div>

            <form method="get" th:action="@{/events}"
                  style="display: flex; gap: 20px; align-items: center; margin-bottom: 25px;">

                <label>
                    Category:
                    <select name="category" style="margin-left: 5px;">
                        <option value="">All</option>
                        <option th:each="cat : ${categories}"
                                th:value="${cat.id}"
                                th:text="${cat.name}">
                        </option>
                    </select>
                </label>

                <label>
                    Location:
                    <select name="location" style="margin-left: 5px;">
                        <option value="">All</option>
                        <option th:each="loc : ${locations}"
                                th:value="${loc.id}"
                                th:text="${loc.name}">
                        </option>
                    </select>
                </label>

                <button type="submit"
                        style="padding: 6px 14px; background-color: #3498db;
                               color: white; border: none; border-radius: 4px;
                               cursor: pointer;">
                    Filter
                </button>
            </form>

            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                <tr style="background-color: #f2f2f2;">
                    <th style="padding: 12px;">Title</th>
                    <th style="padding: 12px;">Description</th>
                    <th style="padding: 12px;">Date</th>
                    <th style="padding: 12px;">Category</th>
                    <th style="padding: 12px;">Location</th>
                    <th style="padding: 12px;">Created By</th>
                    <th style="padding: 12px;">Edit</th>
                    <th style="padding: 12px;">Delete</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="event : ${events.content}" style="border-bottom: 1px solid #eee;">
                    <td style="padding: 10px;" th:text="${event.title}"></td>
                    <td style="padding: 10px;" th:text="${event.description}"></td>
                    <td style="padding: 10px;" th:text="${event.eventDate}"></td>
                    <td style="padding: 10px;" th:text="${event.category != null ? event.category.name : 'N/A'}"></td>
                    <td style="padding: 10px;" th:text="${event.location != null ? event.location.name : 'N/A'}"></td>
                    <td style="padding: 10px;" th:text="${event.user.username}"></td>

                    <td style="padding: 10px;">
                        <a th:href="@{/events/edit/{id}(id=${event.id})}"
                           style="color: #2980b9; text-decoration: none;">
                            Edit
                        </a>
                    </td>

                    <td style="padding: 10px;">
                        <form th:action="@{/events/delete/{id}(id=${event.id})}" method="post">
                            <button type="submit"
                                    style="background-color: #e74c3c;
                                               border: none;
                                               color: white;
                                               padding: 6px 10px;
                                               border-radius: 4px;
                                               cursor: pointer;">
                                Delete
                            </button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>

            <div style="margin-top: 25px; display: flex; justify-content: center; gap: 20px;">
                <a th:if="${events.hasPrevious()}"
                   th:href="@{/events(page=${events.number - 1})}">
                    ← Previous
                </a>

                <span>Page [[${events.number + 1}]]</span>

                <a th:if="${events.hasNext()}"
                   th:href="@{/events(page=${events.number + 1})}">
                    Next →
                </a>
            </div>

        </div>
    </section>

</div>
</html>